<div class="form-container">
    <div class="form-card">
        <div class="form-header">
            <h2 class="form-title">{{ isEdit ? 'âœï¸ Cáº­p nháº­t bÃ i Ä‘Äƒng' : 'ğŸ“¢ ÄÄƒng bÃ i cho thuÃª' }}</h2>
            <p class="form-subtitle">{{ isEdit ? 'Chá»‰nh sá»­a thÃ´ng tin bÃ i Ä‘Äƒng' : 'Táº¡o bÃ i Ä‘Äƒng má»›i Ä‘á»ƒ quáº£ng cÃ¡o phÃ²ng trá» cá»§a báº¡n' }}</p>
        </div>

        <form (ngSubmit)="submit()" class="form-body">
            <div class="form-group">
                <label class="form-label">
                    <span class="label-text">ğŸ¢ Chá»n trá»</span>
                    <span class="label-required">*</span>
                </label>
                <div style="display:flex; gap: 10px; align-items: center;">
                    <select [(ngModel)]="selectedHostelId" name="hostelId" required class="form-select" (change)="onHostelChange()" style="flex: 1;">
                        <option [ngValue]="null">-- Chá»n trá» --</option>
                        <option *ngFor="let h of hostels" [ngValue]="(h.id ?? h.hostelId)">{{ h.name }}</option>
                    </select>
                    <button type="button" class="btn btn-secondary" (click)="reloadHostels()">Táº£i láº¡i</button>
                </div>
                <p class="form-hint">Chá»n trá» cá»§a báº¡n Ä‘á»ƒ lá»c danh sÃ¡ch phÃ²ng</p>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span class="label-text">ğŸ  Chá»n phÃ²ng</span>
                    <span class="label-required">*</span>
                </label>
                <select [(ngModel)]="form.roomId" name="roomId" required class="form-select">
                    <option [ngValue]="null">-- Chá»n phÃ²ng Ä‘á»ƒ Ä‘Äƒng bÃ i --</option>
                    <option *ngFor="let room of rooms" [ngValue]="(room.id ?? room.roomId)">
                        {{ room.title }}
                    </option>
                </select>
                <p class="form-hint">Chá»n phÃ²ng mÃ  báº¡n muá»‘n Ä‘Äƒng bÃ i cho thuÃª</p>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span class="label-text">ğŸ“ TiÃªu Ä‘á» bÃ i Ä‘Äƒng</span>
                    <span class="label-required">*</span>
                </label>
                <input [(ngModel)]="form.title" name="title" required class="form-input"
                    placeholder="VD: Cho thuÃª phÃ²ng trá» giÃ¡ ráº» gáº§n trÆ°á»ng ÄH" />
                <p class="form-hint">TiÃªu Ä‘á» háº¥p dáº«n sáº½ thu hÃºt nhiá»u ngÆ°á»i thuÃª hÆ¡n</p>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span class="label-text">ğŸ“„ MÃ´ táº£ chi tiáº¿t</span>
                </label>
                <textarea [(ngModel)]="form.description" name="description" rows="6" class="form-textarea"
                    placeholder="MÃ´ táº£ chi tiáº¿t vá» phÃ²ng trá»: diá»‡n tÃ­ch, tiá»‡n nghi, vá»‹ trÃ­, giÃ¡ cáº£..."></textarea>
                <p class="form-hint">MÃ´ táº£ cÃ ng chi tiáº¿t cÃ ng tá»‘t Ä‘á»ƒ ngÆ°á»i thuÃª hiá»ƒu rÃµ vá» phÃ²ng</p>
            </div>

            <div class="form-group">
                <label class="form-label">
                    <span class="label-text">ğŸ–¼ï¸ áº¢nh bÃ i Ä‘Äƒng</span>
                </label>
                <input type="file" accept="image/*" multiple (change)="onFilesSelected($event)" class="form-input" />
                <p class="form-hint">Chá»n 1 hoáº·c nhiá»u áº£nh (áº£nh sáº½ gáº¯n vÃ o phÃ²ng Ä‘á»ƒ hiá»ƒn thá»‹ trÃªn trang chá»§)</p>

                <div class="image-grid" *ngIf="images.length">
                    <div class="image-item" *ngFor="let img of images; let i = index">
                        <img [src]="getPreviewUrl(img)" alt="preview" class="preview" />
                        <button type="button" class="remove" (click)="removeImage(i)">âœ•</button>
                    </div>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">
                        <span class="label-text">ğŸ‘ï¸ Tráº¡ng thÃ¡i</span>
                    </label>
                    <select [(ngModel)]="form.status" name="status" class="form-select">
                        <option value="VISIBLE">Hiá»ƒn thá»‹</option>
                        <option value="HIDDEN">áº¨n</option>
                    </select>
                    <p class="form-hint">Chá»n "Hiá»ƒn thá»‹" Ä‘á»ƒ ngÆ°á»i khÃ¡c cÃ³ thá»ƒ tháº¥y</p>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                    <span *ngIf="!isLoading">{{ isEdit ? 'ğŸ’¾ LÆ°u thay Ä‘á»•i' : 'âœ¨ ÄÄƒng bÃ i' }}</span>
                    <span *ngIf="isLoading">â³ Äang xá»­ lÃ½...</span>
                </button>
                <a routerLink="/host/listings" class="btn btn-secondary">âŒ Há»§y</a>
            </div>
        </form>

        <div class="message success" *ngIf="message && !message.includes('tháº¥t báº¡i')">{{ message }}</div>
        <div class="message error" *ngIf="message && message.includes('tháº¥t báº¡i')">{{ message }}</div>
    </div>
</div>