<div class="page">
  <header class="header">
    <div class="brand">
      <span class="material-symbols-outlined brand-icon">home</span>
      <a routerLink="/">QL Phòng Trọ</a>
    </div>

    <nav class="nav">
      <a routerLink="/home" routerLinkActive="active">
        <span class="material-symbols-outlined">dashboard</span>
        <span>Trang chủ</span>
      </a>

      <!-- Người thuê -->
      <a *ngIf="hasRole('renter')" routerLink="/renter/rental-history" routerLinkActive="active">
        <span class="material-symbols-outlined">history</span>
        <span>Lịch sử thuê</span>
      </a>

      <!-- Chủ trọ -->
      <a *ngIf="hasRole('owner')" routerLink="/host/hostels" routerLinkActive="active">
        <span class="material-symbols-outlined">apartment</span>
        <span>Quản lý trọ</span>
      </a>
      <a *ngIf="hasRole('owner')" routerLink="/host/listings" routerLinkActive="active">
        <span class="material-symbols-outlined">description</span>
        <span>Bài đăng</span>
      </a>
      <a *ngIf="hasRole('owner')" routerLink="/host/rental-requests" routerLinkActive="active"
        class="nav-item-with-badge">
        <span class="material-symbols-outlined">mark_email_unread</span>
        <span>Yêu cầu thuê/trả</span>
        <span class="badge" *ngIf="pendingRequestCount > 0">{{ pendingRequestCount }}</span>
      </a>

      <!-- Quản trị viên -->
      <a *ngIf="hasRole('admin')" routerLink="/admin/dashboard" routerLinkActive="active">
        <span class="material-symbols-outlined">analytics</span>
        <span>Tổng quan</span>
      </a>
      <a *ngIf="hasRole('admin')" routerLink="/admin/users" routerLinkActive="active">
        <span class="material-symbols-outlined">group</span>
        <span>Người dùng</span>
      </a>
    </nav>

    <div class="auth">
      <ng-container *ngIf="user$ | async as user; else guest">
        <a routerLink="/profile" class="user-pill">
          <img class="user-avatar" *ngIf="getUserAvatarSrc(user); else userIcon" [src]="getUserAvatarSrc(user)"
            alt="Avatar" />
          <ng-template #userIcon>
            <span class="user-avatar placeholder">
              <span class="material-symbols-outlined">account_circle</span>
            </span>
          </ng-template>
          <span class="user-name">{{ user.fullName }}</span>
        </a>
        <button class="link-btn logout-btn" type="button" (click)="logout()">
          <span class="material-symbols-outlined">logout</span>
          <span>Đăng xuất</span>
        </button>
      </ng-container>

      <ng-template #guest>
        <a routerLink="/auth/login" class="link-btn">
          <span class="material-symbols-outlined">login</span>
          <span>Đăng nhập</span>
        </a>
        <a routerLink="/auth/register" class="link-btn secondary">
          <span class="material-symbols-outlined">person_add</span>
          <span>Đăng ký</span>
        </a>
      </ng-template>
    </div>
  </header>

  <main class="content">
    <router-outlet></router-outlet>
  </main>

  <app-dialog-host></app-dialog-host>

  <footer class="footer">
    <div class="footer-content">
      <span class="footer-text">© 2025 - Quản lý phòng Trọ</span>
      <div class="footer-links">
        <a href="#" class="footer-link">Điều khoản</a>
        <span class="footer-divider">•</span>
        <a href="#" class="footer-link">Chính sách</a>
        <span class="footer-divider">•</span>
        <a href="#" class="footer-link">Liên hệ</a>
      </div>
    </div>
  </footer>
</div>