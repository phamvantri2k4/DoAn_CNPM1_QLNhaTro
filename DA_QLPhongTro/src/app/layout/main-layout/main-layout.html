<div class="page">
  <header class="header">
    <div class="brand">
      <a routerLink="/">QL Phòng Trọ</a>
    </div>
    <nav class="nav">
      <a routerLink="/home" routerLinkActive="active">Trang chủ</a>

      <!-- Người thuê -->
      <a *ngIf="hasRole('renter')" routerLink="/renter/rental-history" routerLinkActive="active">Lịch sử thuê</a>

      <!-- Chủ trọ -->
      <a *ngIf="hasRole('owner')" routerLink="/host/hostels" routerLinkActive="active">Quản lý trọ</a>
      <a *ngIf="hasRole('owner')" routerLink="/host/listings" routerLinkActive="active">Bài đăng</a>
      <a *ngIf="hasRole('owner')" routerLink="/host/rental-requests" routerLinkActive="active">
        Yêu cầu thuê/trả
        <span class="badge" *ngIf="pendingRequestCount > 0">{{ pendingRequestCount }}</span>
      </a>

      <!-- Quản trị viên -->
      <a *ngIf="hasRole('admin')" routerLink="/admin/dashboard" routerLinkActive="active">Tổng quan</a>
      <a *ngIf="hasRole('admin')" routerLink="/admin/users" routerLinkActive="active">Người dùng</a>
    </nav>
    <div class="auth">
      <ng-container *ngIf="user$ | async as user; else guest">
        <a routerLink="/profile" class="user-pill">
          <img class="user-avatar" *ngIf="getUserAvatarSrc(user); else userIcon" [src]="getUserAvatarSrc(user)" alt="Avatar" />
          <ng-template #userIcon>
            <span class="user-avatar placeholder" aria-hidden="true">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12a4.5 4.5 0 1 0-4.5-4.5A4.5 4.5 0 0 0 12 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4 20a8 8 0 0 1 16 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </ng-template>
          <span class="user-name">{{ user.fullName }}</span>
        </a>
        <button class="link-btn" type="button" (click)="logout()">Đăng xuất</button>
      </ng-container>

      <ng-template #guest>
        <a routerLink="/auth/login" class="link-btn">Đăng nhập</a>
        <a routerLink="/auth/register" class="link-btn secondary">Đăng ký</a>
      </ng-template>
    </div>
  </header>

  <main class="content">
    <router-outlet></router-outlet>
  </main>

  <app-dialog-host></app-dialog-host>

  <footer class="footer">
    <span> 2025 - Quản lý phòng Trọ</span>
  </footer>
</div>